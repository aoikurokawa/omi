---
title: Authorize
description: Change the stake or withdraw authority of a stake account.
---

## Overview

| Property | Value |
|----------|-------|
| Instruction Index | 1 |
| Estimated CU | ~10,500 |

The `Authorize` instruction changes one of the stake account's authorities to a new public key.

## Accounts

| Index | Name | Writable | Signer | Description |
|-------|------|----------|--------|-------------|
| 0 | Stake Account | ✅ | ❌ | The stake account to modify |
| 1 | Clock Sysvar | ❌ | ❌ | `SysvarC1ock11111111111111111111111111111111` |
| 2 | Current Authority | ❌ | ✅ | Current authority must sign |
| 3 | Lockup Authority | ❌ | ✅ | (Optional) Required if lockup active and changing withdrawer |

## Arguments

| Field | Type | Description |
|-------|------|-------------|
| `newAuthority` | Pubkey | New authority public key |
| `stakeAuthorize` | StakeAuthorize | Which authority to change |

```rust
pub enum StakeAuthorize {
    Staker,     // 0
    Withdrawer, // 1
}
```

## Authorization Rules

| Changing | Required Signer |
|----------|-----------------|
| Stake Authority | Current stake authority OR current withdraw authority |
| Withdraw Authority | Current withdraw authority only |
| Withdraw Authority (locked) | Current withdraw authority AND lockup custodian |

## Examples

### TypeScript (web3.js v1)

```typescript
import {
  Connection,
  PublicKey,
  Transaction,
  StakeProgram,
  StakeAuthorizationType,
  sendAndConfirmTransaction,
} from '@solana/web3.js';

const connection = new Connection('https://api.mainnet-beta.solana.com', 'confirmed');

const stakeAccountPubkey = new PublicKey('...');
const currentAuthority = /* Keypair */;
const newAuthorityPubkey = new PublicKey('...');

// Change stake authority
const authorizeStakerIx = StakeProgram.authorize({
  stakePubkey: stakeAccountPubkey,
  authorizedPubkey: currentAuthority.publicKey,
  newAuthorizedPubkey: newAuthorityPubkey,
  stakeAuthorizationType: StakeAuthorizationType.Staker,
});

// Change withdraw authority
const authorizeWithdrawerIx = StakeProgram.authorize({
  stakePubkey: stakeAccountPubkey,
  authorizedPubkey: currentAuthority.publicKey, // Must be current withdrawer
  newAuthorizedPubkey: newAuthorityPubkey,
  stakeAuthorizationType: StakeAuthorizationType.Withdrawer,
});

const tx = new Transaction().add(authorizeStakerIx);
await sendAndConfirmTransaction(connection, tx, [payer, currentAuthority]);
```

### TypeScript (@solana-program/stake)

```typescript
import { 
  getAuthorizeInstruction, 
  StakeAuthorize 
} from '@solana-program/stake';
import { CLOCK_SYSVAR_ADDRESS } from '@solana/kit';

const authorizeIx = getAuthorizeInstruction({
  stakeAccount: stakeAccountAddress,
  authority: currentAuthoritySigner,
  newAuthority: newAuthorityAddress,
  stakeAuthorize: StakeAuthorize.Staker,
  clock: CLOCK_SYSVAR_ADDRESS,
});
```

### Rust

```rust
use solana_sdk::{
    pubkey::Pubkey,
    signature::{Keypair, Signer},
    stake::{
        instruction as stake_instruction,
        state::StakeAuthorize,
    },
    transaction::Transaction,
};

fn authorize_stake(
    client: &RpcClient,
    payer: &Keypair,
    stake_account: &Pubkey,
    current_authority: &Keypair,
    new_authority: &Pubkey,
    stake_authorize: StakeAuthorize,
) -> Result<(), Box<dyn std::error::Error>> {
    let authorize_ix = stake_instruction::authorize(
        stake_account,
        &current_authority.pubkey(),
        new_authority,
        stake_authorize,
        None, // custodian (for locked accounts)
    );

    let recent_blockhash = client.get_latest_blockhash()?;
    let tx = Transaction::new_signed_with_payer(
        &[authorize_ix],
        Some(&payer.pubkey()),
        &[payer, current_authority],
        recent_blockhash,
    );

    client.send_and_confirm_transaction(&tx)?;
    Ok(())
}
```

### CLI

```bash
# Change stake authority
solana stake-authorize <STAKE_ACCOUNT_ADDRESS> \
  --new-stake-authority <NEW_STAKE_AUTHORITY_PUBKEY>

# Change withdraw authority
solana stake-authorize <STAKE_ACCOUNT_ADDRESS> \
  --new-withdraw-authority <NEW_WITHDRAW_AUTHORITY_PUBKEY>

# Change both at once
solana stake-authorize <STAKE_ACCOUNT_ADDRESS> \
  --new-stake-authority <NEW_STAKE_AUTHORITY_PUBKEY> \
  --new-withdraw-authority <NEW_WITHDRAW_AUTHORITY_PUBKEY>
```

---


---
