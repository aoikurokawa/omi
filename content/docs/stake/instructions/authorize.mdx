---
title: Authorize
description: Change the stake or withdraw authority of a stake account.
---

## Overview

| Property | Value |
|----------|-------|
| Instruction Index | 1 |
| Estimated CU | ~10,500 |

The `Authorize` instruction changes one of the stake account's authorities to a new public key.

## Accounts

| Index | Name | Writable | Signer | Description |
|-------|------|----------|--------|-------------|
| 0 | Stake Account | ✅ | ❌ | The stake account to modify |
| 1 | Clock Sysvar | ❌ | ❌ | `SysvarC1ock11111111111111111111111111111111` |
| 2 | Current Authority | ❌ | ✅ | Current authority must sign |
| 3 | Lockup Authority | ❌ | ✅ | (Optional) Required if lockup active and changing withdrawer |

## Arguments

| Field | Type | Description |
|-------|------|-------------|
| `newAuthority` | Pubkey | New authority public key |
| `stakeAuthorize` | StakeAuthorize | Which authority to change |

```rust
pub enum StakeAuthorize {
    Staker,     // 0
    Withdrawer, // 1
}
```

## Authorization Rules

| Changing | Required Signer |
|----------|-----------------|
| Stake Authority | Current stake authority OR current withdraw authority |
| Withdraw Authority | Current withdraw authority only |
| Withdraw Authority (locked) | Current withdraw authority AND lockup custodian |

## Examples

### TypeScript (web3.js v1)

```typescript
import {
  Connection,
  PublicKey,
  Transaction,
  StakeProgram,
  StakeAuthorizationType,
  sendAndConfirmTransaction,
} from '@solana/web3.js';

const connection = new Connection('https://api.mainnet-beta.solana.com', 'confirmed');

const stakeAccountPubkey = new PublicKey('...');
const currentAuthority = /* Keypair */;
const newAuthorityPubkey = new PublicKey('...');

// Change stake authority
const authorizeStakerIx = StakeProgram.authorize({
  stakePubkey: stakeAccountPubkey,
  authorizedPubkey: currentAuthority.publicKey,
  newAuthorizedPubkey: newAuthorityPubkey,
  stakeAuthorizationType: StakeAuthorizationType.Staker,
});

// Change withdraw authority
const authorizeWithdrawerIx = StakeProgram.authorize({
  stakePubkey: stakeAccountPubkey,
  authorizedPubkey: currentAuthority.publicKey, // Must be current withdrawer
  newAuthorizedPubkey: newAuthorityPubkey,
  stakeAuthorizationType: StakeAuthorizationType.Withdrawer,
});

const tx = new Transaction().add(authorizeStakerIx);
await sendAndConfirmTransaction(connection, tx, [payer, currentAuthority]);
```

### TypeScript (@solana-program/stake)

```typescript
import { 
  getAuthorizeInstruction, 
  StakeAuthorize 
} from '@solana-program/stake';
import { CLOCK_SYSVAR_ADDRESS } from '@solana/kit';

const authorizeIx = getAuthorizeInstruction({
  stakeAccount: stakeAccountAddress,
  authority: currentAuthoritySigner,
  newAuthority: newAuthorityAddress,
  stakeAuthorize: StakeAuthorize.Staker,
  clock: CLOCK_SYSVAR_ADDRESS,
});
```

### Rust

```rust
use solana_sdk::{
    pubkey::Pubkey,
    signature::{Keypair, Signer},
    stake::{
        instruction as stake_instruction,
        state::StakeAuthorize,
    },
    transaction::Transaction,
};

fn authorize_stake(
    client: &RpcClient,
    payer: &Keypair,
    stake_account: &Pubkey,
    current_authority: &Keypair,
    new_authority: &Pubkey,
    stake_authorize: StakeAuthorize,
) -> Result<(), Box<dyn std::error::Error>> {
    let authorize_ix = stake_instruction::authorize(
        stake_account,
        &current_authority.pubkey(),
        new_authority,
        stake_authorize,
        None, // custodian (for locked accounts)
    );

    let recent_blockhash = client.get_latest_blockhash()?;
    let tx = Transaction::new_signed_with_payer(
        &[authorize_ix],
        Some(&payer.pubkey()),
        &[payer, current_authority],
        recent_blockhash,
    );

    client.send_and_confirm_transaction(&tx)?;
    Ok(())
}
```

### CLI

```bash
# Change stake authority
solana stake-authorize <STAKE_ACCOUNT_ADDRESS> \
  --new-stake-authority <NEW_STAKE_AUTHORITY_PUBKEY>

# Change withdraw authority
solana stake-authorize <STAKE_ACCOUNT_ADDRESS> \
  --new-withdraw-authority <NEW_WITHDRAW_AUTHORITY_PUBKEY>

# Change both at once
solana stake-authorize <STAKE_ACCOUNT_ADDRESS> \
  --new-stake-authority <NEW_STAKE_AUTHORITY_PUBKEY> \
  --new-withdraw-authority <NEW_WITHDRAW_AUTHORITY_PUBKEY>
```

---

# AuthorizeChecked

Authorize with additional verification that the new authority signs.

## Overview

| Property | Value |
|----------|-------|
| Instruction Index | 10 |
| Estimated CU | ~10,200 |

Identical to `Authorize`, but requires the new authority to also sign the transaction. This prevents accidentally setting an incorrect authority.

## Accounts

| Index | Name | Writable | Signer | Description |
|-------|------|----------|--------|-------------|
| 0 | Stake Account | ✅ | ❌ | The stake account to modify |
| 1 | Clock Sysvar | ❌ | ❌ | `SysvarC1ock11111111111111111111111111111111` |
| 2 | Current Authority | ❌ | ✅ | Current authority must sign |
| 3 | New Authority | ❌ | ✅ | New authority must also sign |
| 4 | Lockup Authority | ❌ | ✅ | (Optional) Required if lockup active |

## Example

```typescript
import { StakeProgram, StakeAuthorizationType } from '@solana/web3.js';

const authorizeCheckedIx = StakeProgram.authorizeChecked({
  stakePubkey: stakeAccountPubkey,
  authorizedPubkey: currentAuthority.publicKey,
  newAuthorizedPubkey: newAuthority.publicKey, // Must also sign
  stakeAuthorizationType: StakeAuthorizationType.Staker,
});

// Both current and new authority must sign
const tx = new Transaction().add(authorizeCheckedIx);
await sendAndConfirmTransaction(connection, tx, [
  payer,
  currentAuthority,
  newAuthority, // Required!
]);
```

---

# AuthorizeWithSeed

Authorize using a derived key (Program Derived Address pattern).

## Overview

| Property | Value |
|----------|-------|
| Instruction Index | 8 |
| Estimated CU | ~11,700 |

Allows authorization using a key derived from a base key and seed, useful for deterministic key management.

## Accounts

| Index | Name | Writable | Signer | Description |
|-------|------|----------|--------|-------------|
| 0 | Stake Account | ✅ | ❌ | The stake account to modify |
| 1 | Base Key | ❌ | ✅ | Base key for derivation |
| 2 | Clock Sysvar | ❌ | ❌ | `SysvarC1ock11111111111111111111111111111111` |
| 3 | Lockup Authority | ❌ | ✅ | (Optional) Required if lockup active |

## Arguments

```rust
pub struct AuthorizeWithSeedArgs {
    pub new_authorized_pubkey: Pubkey,
    pub stake_authorize: StakeAuthorize,
    pub authority_seed: String,
    pub authority_owner: Pubkey,
}
```

## Example

```typescript
import { PublicKey, StakeProgram, StakeAuthorizationType } from '@solana/web3.js';

const seed = 'stake-authority:0';
const currentAuthority = await PublicKey.createWithSeed(
  baseKey.publicKey,
  seed,
  StakeProgram.programId
);

const authorizeWithSeedIx = StakeProgram.authorizeWithSeed({
  stakePubkey: stakeAccountPubkey,
  authorityBase: baseKey.publicKey,
  authoritySeed: seed,
  authorityOwner: StakeProgram.programId,
  newAuthorizedPubkey: newAuthorityPubkey,
  stakeAuthorizationType: StakeAuthorizationType.Staker,
});

// Base key signs (not the derived key)
const tx = new Transaction().add(authorizeWithSeedIx);
await sendAndConfirmTransaction(connection, tx, [payer, baseKey]);
```

---

# AuthorizeCheckedWithSeed

Combines `AuthorizeWithSeed` and `AuthorizeChecked`.

## Overview

| Property | Value |
|----------|-------|
| Instruction Index | 11 |
| Estimated CU | ~11,500 |

Authorizes using a derived key while also requiring the new authority to sign.

## Accounts

| Index | Name | Writable | Signer | Description |
|-------|------|----------|--------|-------------|
| 0 | Stake Account | ✅ | ❌ | The stake account to modify |
| 1 | Base Key | ❌ | ✅ | Base key for derivation |
| 2 | Clock Sysvar | ❌ | ❌ | `SysvarC1ock11111111111111111111111111111111` |
| 3 | New Authority | ❌ | ✅ | New authority must sign |
| 4 | Lockup Authority | ❌ | ✅ | (Optional) Required if lockup active |

## Example

```typescript
const authorizeCheckedWithSeedIx = StakeProgram.authorizeCheckedWithSeed({
  stakePubkey: stakeAccountPubkey,
  authorityBase: baseKey.publicKey,
  authoritySeed: seed,
  authorityOwner: StakeProgram.programId,
  newAuthorizedPubkey: newAuthority.publicKey,
  stakeAuthorizationType: StakeAuthorizationType.Staker,
});

// Both base key and new authority must sign
const tx = new Transaction().add(authorizeCheckedWithSeedIx);
await sendAndConfirmTransaction(connection, tx, [
  payer,
  baseKey,
  newAuthority,
]);
```

---

## Errors

| Error | Cause |
|-------|-------|
| `MissingRequiredSignature` | Required signer not present |
| `InvalidAccountData` | Account not a valid stake account |
| `LockupInEffect` | Lockup active but custodian not provided |
| `CustodianMissing` | Changing withdrawer on locked account without custodian |

## Security Best Practices

1. **Use Checked Variants**: When setting up delegation for others, use `AuthorizeChecked` to ensure consent
2. **Separate Authorities**: Use different keys for stake and withdraw authorities
3. **Secure Withdraw Authority**: Store withdraw authority in cold storage
4. **Verify Addresses**: Double-check new authority addresses before signing
5. **Test First**: Test authority changes on devnet before mainnet
