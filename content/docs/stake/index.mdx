---
title: Introduction
description: Understanding Solana's native staking program
---

# Stake Program

The Stake Program is Solana's native on-chain program for staking SOL to validators. It's the foundation of Solana's Proof-of-Stake consensus mechanism.

## Interactive Visualization

<StakeProgramFlow />

## Stake Account Lifecycle

A stake account goes through several states during its lifetime:

### 1. Create & Initialize

First, you create a stake account and initialize it with authorities:

- **Stake Authority**: Can delegate, deactivate, and split the stake
- **Withdraw Authority**: Can withdraw funds from the stake account

```rust
// Create stake account
let stake_account = Keypair::new();
let lamports = rent + stake_amount;

create_account(
    &payer,
    &stake_account,
    lamports,
    StakeState::size_of(),
    &stake::program::id(),
)
```

### 2. Delegate

Once initialized, you delegate your stake to a validator's vote account:

```rust
stake::instruction::delegate_stake(
    &stake_account.pubkey(),
    &stake_authority.pubkey(),
    &vote_account.pubkey(),
)
```

### 3. Warmup Period

After delegation, stake enters a **warmup period**. During this time:
- Stake is gradually activated over several epochs
- You earn partial rewards proportional to active stake
- You cannot withdraw until fully activated then deactivated

### 4. Active

Once fully warmed up, your stake is **active**:
- Earns full staking rewards
- Contributes to validator's voting power
- Can be split into multiple stake accounts

### 5. Deactivate

When you want to unstake:

```rust
stake::instruction::deactivate_stake(
    &stake_account.pubkey(),
    &stake_authority.pubkey(),
)
```

### 6. Cooldown Period

Similar to warmup, stake must go through a **cooldown period**:
- Stake is gradually deactivated
- Still earns partial rewards during this time
- Takes approximately 2-3 days

### 7. Withdraw

After cooldown completes, you can withdraw your SOL:

```rust
stake::instruction::withdraw(
    &stake_account.pubkey(),
    &withdraw_authority.pubkey(),
    &destination.pubkey(),
    lamports,
    None,
)
```

## Key Concepts

### Authorities

| Authority | Permissions |
|-----------|-------------|
| Stake Authority | Delegate, deactivate, split, set new authorities |
| Withdraw Authority | Withdraw SOL, close account |

### Lockup

Stake accounts can have an optional **lockup**:
- Prevents withdrawal until a specific Unix timestamp or epoch
- Useful for vesting schedules
- Lockup authority can modify or remove lockup

### Split & Merge

You can **split** a stake account into two:
- Original retains some stake
- New account receives the rest
- Both maintain same delegation

You can **merge** two stake accounts if they:
- Are delegated to the same validator
- Have the same authorities
- Are both fully activated or both fully deactivated

## Common Patterns

### Re-delegation

To switch validators, you must:
1. Deactivate current stake
2. Wait for cooldown
3. Delegate to new validator
4. Wait for warmup

This takes ~4-6 days total, which is why liquid staking exists!

## Links

- https://github.com/solana-program/stake
