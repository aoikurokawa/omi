---
title: IncreaseValidatorStake
description: Move SOL from the reserve to increase a validator's stake.
---

## Overview

| Property | Value |
|----------|-------|
| Instruction Index | 3 |
| Required Authority | Staker |

The `IncreaseValidatorStake` instruction moves SOL from the pool's reserve to a validator's transient stake account, increasing their delegated stake after warmup.

## Accounts

| Index | Name | Writable | Signer | Description |
|-------|------|----------|--------|-------------|
| 0 | Stake Pool | ❌ | ❌ | Stake pool account |
| 1 | Staker | ❌ | ✅ | Pool's staker authority |
| 2 | Withdraw Authority | ❌ | ❌ | Pool's withdraw authority PDA |
| 3 | Validator List | ✅ | ❌ | Pool's validator list account |
| 4 | Reserve Stake | ✅ | ❌ | Pool's reserve stake account |
| 5 | Transient Stake Account | ✅ | ❌ | Validator's transient stake PDA |
| 6 | Validator Stake Account | ❌ | ❌ | Validator's main stake PDA |
| 7 | Vote Account | ❌ | ❌ | Validator's vote account |
| 8 | Clock Sysvar | ❌ | ❌ | Clock sysvar |
| 9 | Rent Sysvar | ❌ | ❌ | Rent sysvar |
| 10 | Stake History Sysvar | ❌ | ❌ | Stake history sysvar |
| 11 | Stake Config | ❌ | ❌ | Stake config account |
| 12 | System Program | ❌ | ❌ | System program |
| 13 | Stake Program | ❌ | ❌ | Native stake program |

## Arguments

| Field | Type | Description |
|-------|------|-------------|
| `lamports` | u64 | Amount of lamports to stake |
| `transient_stake_seed` | u64 | Seed for transient stake PDA |

## Behavior

1. Validates staker authority signature
2. Checks validator is active in the pool
3. Checks reserve has sufficient balance
4. Splits `lamports` from reserve to transient stake account
5. Delegates transient stake to the validator's vote account
6. Updates validator's `transient_stake_lamports` in validator list

## Stake Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                 IncreaseValidatorStake Flow                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Reserve Stake              Transient Stake      Vote Account   │
│  ┌────────────┐            ┌────────────┐       ┌────────────┐ │
│  │  100 SOL   │            │            │       │            │ │
│  │            │ ──split──▶ │  +10 SOL   │ ──▶   │ Validator  │ │
│  │  -10 SOL   │            │ (delegate) │       │            │ │
│  └────────────┘            └────────────┘       └────────────┘ │
│                                  │                              │
│                          Epoch Boundary                         │
│                                  │                              │
│                                  ▼                              │
│  Validator Stake           Transient Stake                      │
│  ┌────────────┐            ┌────────────┐                      │
│  │  +10 SOL   │ ◀──merge── │   (empty)  │                      │
│  │  (active)  │            │            │                      │
│  └────────────┘            └────────────┘                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## Examples

### Rust

```rust
use spl_stake_pool::instruction::increase_validator_stake;

fn increase_stake(
    client: &RpcClient,
    stake_pool: &Pubkey,
    staker: &Keypair,
    vote_account: &Pubkey,
    lamports: u64,
) -> Result<(), Box<dyn std::error::Error>> {
    let stake_pool_data = get_stake_pool(client, stake_pool)?;
    let validator_info = find_validator_info(&stake_pool_data, vote_account)?;
    
    let (withdraw_authority, _) = Pubkey::find_program_address(
        &[stake_pool.as_ref(), b"withdraw"],
        &spl_stake_pool::id(),
    );
    
    let (validator_stake, _) = Pubkey::find_program_address(
        &[
            vote_account.as_ref(),
            stake_pool.as_ref(),
            b"validator",
        ],
        &spl_stake_pool::id(),
    );
    
    let transient_seed = validator_info.transient_seed_suffix;
    let (transient_stake, _) = Pubkey::find_program_address(
        &[
            b"transient",
            vote_account.as_ref(),
            stake_pool.as_ref(),
            &transient_seed.to_le_bytes(),
        ],
        &spl_stake_pool::id(),
    );
    
    let increase_ix = increase_validator_stake(
        &spl_stake_pool::id(),
        stake_pool,
        &staker.pubkey(),
        &withdraw_authority,
        &stake_pool_data.validator_list,
        &stake_pool_data.reserve_stake,
        &transient_stake,
        &validator_stake,
        vote_account,
        lamports,
        transient_seed,
    );
    
    let tx = Transaction::new_signed_with_payer(
        &[increase_ix],
        Some(&staker.pubkey()),
        &[staker],
        client.get_latest_blockhash()?,
    );
    
    client.send_and_confirm_transaction(&tx)?;
    
    println!("Increased stake to {} by {} lamports", vote_account, lamports);
    Ok(())
}
```

### CLI

```bash
# Increase stake to a validator by 10 SOL
spl-stake-pool increase-validator-stake <POOL_ADDRESS> <VOTE_ACCOUNT> 10

# With custom staker keypair
spl-stake-pool increase-validator-stake <POOL_ADDRESS> <VOTE_ACCOUNT> 10 \
    --staker staker.json
```

## Errors

| Error | Cause |
|-------|-------|
| `SignatureMissing` | Staker did not sign |
| `ValidatorNotFound` | Validator not in pool |
| `ReserveDepleted` | Insufficient reserve balance |
| `StakeListOutOfDate` | Validator list needs update |
| `WrongStakeState` | Transient stake in wrong state |

## Warmup Period

After increasing stake:

1. **Transient Account Created**: Stake starts in transient account
2. **Warmup Begins**: Stake activates over multiple epochs
3. **Merge on Update**: `UpdateValidatorListBalance` merges to validator stake

```typescript
// Check transient stake status
const validatorInfo = await getValidatorStakeInfo(pool, voteAccount);

console.log('Active stake:', validatorInfo.activeStakeLamports);
console.log('Transient stake:', validatorInfo.transientStakeLamports);
```

## Multiple Increases

For multiple stake increases in the same epoch, use `IncreaseAdditionalValidatorStake`:

```rust
// First increase
increase_validator_stake(pool, validator, 10_000_000_000);

// Additional increase (same epoch)
increase_additional_validator_stake(pool, validator, 5_000_000_000);
```

## Best Practices

1. **Check Reserve Balance**: Ensure reserve has enough SOL
2. **Monitor Warmup**: Track transient stake through activation
3. **Batch Operations**: Use additional stake for same-epoch changes
4. **Update After Epoch**: Run maintenance to merge transient stake
